<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>A Small Proof that Fin is Injective - Donnacha Oisín Kidney</title>
        <style>body{color:black;font-family:Garamond,Times New Roman,serif;font-size:14px;margin:0px auto 0px auto;padding-left:5px;padding-right:5px;max-width:600px}math{font-size:13px}img{max-width:600px}div#header{border-bottom:3px double black;margin-bottom:30px;padding:12px 0px 12px 0px}div#logo a{color:black;float:left;font-size:20px;text-decoration:none}div#header #navigation{text-align:right}div#header #navigation a{color:black;font-family:Garamond,Times New Roman,Serif;font-size:18px;margin-left:10px;text-decoration:none;text-transform:uppercase}div#footer{font-family:Garamond,Times New Roman,Serif;border-top:solid 2px black;color:#555;font-size:12px;margin-top:30px;padding:12px 0px 12px 0px;text-align:right}h1{font-family:Garamond,Times New Roman,Serif;font-size:22px;font-weight:normal}h2{font-family:Garamond,Times New Roman,Serif;font-size:20px;font-weight:normal}div.info{color:#555;font-size:15px;font-style:italic}span.quiet{color:#828282;font-style:italic}a{color:black;word-wrap:break-word}ul.post-list{margin-left:0px;padding-left:0px;list-style-type:none}.hidden_source{display:none}ol.serieslist{counter-reset:item;list-style-type:none;padding-left:20}ol li.serieslist:before{content:'Part ' counter(item,decimal) ':';counter-increment:item}table.sourceCode,tr.sourceCode,td.lineNumbers,td.sourceCode,table.sourceCode pre{margin:0;padding:0;border:0;vertical-align:baseline;border:none}td.lineNumbers{border-right:1px solid #AAAAAA;text-align:right;color:#AAAAAA;padding-right:5px;padding-left:5px}td.sourceCode{padding-left:5px}.sourceCode,code,pre,.Agda{font-size:11px;font-family:menlo,monospace}.sourceCode span.kw{color:#262C6A}.sourceCode span.dt{color:#476A97}.sourceCode span.dv{color:#262C6A}.sourceCode span.bn{color:#262C6A}.sourceCode span.fl{color:#262C6A}.sourceCode span.ch{color:#262C6A}.sourceCode span.st{color:#702C51}.sourceCode span.co{color:#435138}.sourceCode span.ot{color:#262C6A}.sourceCode span.al{color:red}.sourceCode span.fu{color:#000000}.sourceCode span.re{color:#000000}.sourceCode span.er{color:red}li{margin-bottom:2px}li:last-child{margin-bottom:0px}.Agda .Comment{color:#B22222}.Agda .Background{}.Agda .Markup{color:#000000}.Agda .Keyword{color:#CD6600}.Agda .String{color:#B22222}.Agda .Number{color:#A020F0}.Agda .Symbol{color:#404040}.Agda .PrimitiveType{color:#0000CD}.Agda .Pragma{color:black}.Agda .Operator{}.Agda .Bound{color:black}.Agda .Generalizable{color:black}.Agda .InductiveConstructor{color:#008B00}.Agda .CoinductiveConstructor{color:#8B7500}.Agda .Datatype{color:#0000CD}.Agda .Field{color:#EE1289}.Agda .Function{color:#0000CD}.Agda .Module{color:#A020F0}.Agda .Postulate{color:#0000CD}.Agda .Primitive{color:#0000CD}.Agda .Record{color:#0000CD}.Agda .DottedPattern{}.Agda .UnsolvedMeta{color:black;background:yellow}.Agda .UnsolvedConstraint{color:black;background:yellow}.Agda .TerminationProblem{color:black;background:#FFA07A}.Agda .IncompletePattern{color:black;background:#F5DEB3}.Agda .Error{color:red;text-decoration:underline}.Agda .TypeChecks{color:black;background:#ADD8E6}.Agda a{text-decoration:none}.Agda a[href]:hover{background-color:#B4EEB4}.sourceCode{overflow-x:auto}</style>
    </head>
    <body>
        <div id="header">
            <div id="logo">
                <a href="../">Donnacha Oisín Kidney</a>
            </div>
            <div id="navigation">
                <a href="../about.html">About</a>
                <a href="../contact.html">Contact</a>
                <a href="../rss.xml">Feed</a>
            </div>
        </div>

        <div id="content">
            <h2>A Small Proof that Fin is Injective</h2>

            <div class="info">
    Posted on November 15, 2019
</div>
<div class="info">
    
</div>
<div class="info">
    
        Tags: <a title="All pages tagged 'Agda'." href="../tags/Agda.html">Agda</a>
    
</div>

<details>
<p><summary>Imports etc.</summary></p>
<pre class="Agda"><a id="115" class="Symbol">{-#</a> <a id="119" class="Keyword">OPTIONS</a> <a id="127" class="Pragma">--safe</a> <a id="134" class="Pragma">--without-K</a> <a id="146" class="Symbol">#-}</a>

<a id="151" class="Keyword">module</a> <a id="158" href class="Module">Post</a> <a id="163" class="Keyword">where</a>

<a id="170" class="Keyword">open</a> <a id="175" class="Keyword">import</a> <a id="182" href="../code/fininj/Data.Fin.html" class="Module">Data.Fin</a>                              <a id="220" class="Keyword">using</a> <a id="226" class="Symbol">(</a><a id="227" href="../code/fininj/Data.Fin.Base.html#1061" class="Datatype">Fin</a><a id="230" class="Symbol">;</a> <a id="232" href="../code/fininj/Data.Fin.Base.html#1114" class="InductiveConstructor">suc</a><a id="235" class="Symbol">;</a> <a id="237" href="../code/fininj/Data.Fin.Base.html#1083" class="InductiveConstructor">zero</a><a id="241" class="Symbol">;</a> <a id="243" href="../code/fininj/Data.Fin.Properties.html#1997" class="../code/fininj/Function Operator">_≟_</a><a id="246" class="Symbol">)</a>
<a id="248" class="Keyword">open</a> <a id="253" class="Keyword">import</a> <a id="260" href="../code/fininj/Data.Nat.html" class="Module">Data.Nat</a>                              <a id="298" class="Keyword">using</a> <a id="304" class="Symbol">(</a><a id="305" href="../code/fininj/Agda.Builtin.Nat.html#165" class="Datatype">ℕ</a><a id="306" class="Symbol">;</a> <a id="308" href="../code/fininj/Agda.Builtin.Nat.html#196" class="InductiveConstructor">suc</a><a id="311" class="Symbol">;</a> <a id="313" href="../code/fininj/Agda.Builtin.Nat.html#183" class="InductiveConstructor">zero</a><a id="317" class="Symbol">;</a> <a id="319" href="../code/fininj/Agda.Builtin.Nat.html#298" class="Primitive Operator">_+_</a><a id="322" class="Symbol">;</a> <a id="324" href="../code/fininj/Data.Nat.Base.html#3697" class="../code/fininj/Function">compare</a><a id="331" class="Symbol">;</a> <a id="333" href="../code/fininj/Data.Nat.Base.html#3620" class="InductiveConstructor">equal</a><a id="338" class="Symbol">;</a> <a id="340" href="../code/fininj/Data.Nat.Base.html#3653" class="InductiveConstructor">greater</a><a id="347" class="Symbol">;</a> <a id="349" href="../code/fininj/Data.Nat.Base.html#3575" class="InductiveConstructor">less</a><a id="353" class="Symbol">)</a>
<a id="355" class="Keyword">open</a> <a id="360" class="Keyword">import</a> <a id="367" href="../code/fininj/Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a>                   <a id="405" class="Keyword">using</a> <a id="411" class="Symbol">(</a><a id="412" href="../code/fininj/Data.Nat.Properties.html#12828" class="../code/fininj/Function">+-comm</a><a id="418" class="Symbol">)</a>
<a id="420" class="Keyword">open</a> <a id="425" class="Keyword">import</a> <a id="432" href="../code/fininj/Data.Bool.html" class="Module">Data.Bool</a>                             <a id="470" class="Keyword">using</a> <a id="476" class="Symbol">(</a><a id="477" href="../code/fininj/Data.Bool.Base.html#932" class="../code/fininj/Function">not</a><a id="480" class="Symbol">;</a> <a id="482" href="../code/fininj/Data.Bool.Base.html#1451" class="../code/fininj/Function">T</a><a id="483" class="Symbol">)</a>
<a id="485" class="Keyword">open</a> <a id="490" class="Keyword">import</a> <a id="497" href="../code/fininj/Relation.Nullary.html" class="Module">Relation.Nullary</a>                      <a id="535" class="Keyword">using</a> <a id="541" class="Symbol">(</a><a id="542" href="../code/fininj/Relation.Nullary.html#1645">yes</a><a id="545" class="Symbol">;</a> <a id="547" href="../code/fininj/Relation.Nullary.html#1682">no</a><a id="549" class="Symbol">;</a> <a id="551" href="../code/fininj/Relation.Nullary.html#1578" class="Field">does</a><a id="555" class="Symbol">;</a> <a id="557" href="../code/fininj/Relation.Nullary.html#653" class="../code/fininj/Function Operator">¬_</a><a id="559" class="Symbol">)</a>
<a id="561" class="Keyword">open</a> <a id="566" class="Keyword">import</a> <a id="573" href="../code/fininj/Data.Product.html" class="Module">Data.Product</a>                          <a id="611" class="Keyword">using</a> <a id="617" class="Symbol">(</a><a id="618" href="../code/fininj/Agda.Builtin.Sigma.html#139" class="Record">Σ</a><a id="619" class="Symbol">;</a> <a id="621" href="../code/fininj/Data.Product.html#916" class="../code/fininj/Function">Σ-syntax</a><a id="629" class="Symbol">;</a> <a id="631" href="../code/fininj/Agda.Builtin.Sigma.html#225" class="Field">proj₁</a><a id="636" class="Symbol">;</a> <a id="638" href="../code/fininj/Agda.Builtin.Sigma.html#237" class="Field">proj₂</a><a id="643" class="Symbol">;</a> <a id="645" href="../code/fininj/Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">_,_</a><a id="648" class="Symbol">)</a>
<a id="650" class="Keyword">open</a> <a id="655" class="Keyword">import</a> <a id="662" href="../code/fininj/Data.Unit.html" class="Module">Data.Unit</a>                             <a id="700" class="Keyword">using</a> <a id="706" class="Symbol">(</a><a id="707" href="../code/fininj/Agda.Builtin.Unit.html#174" class="InductiveConstructor">tt</a><a id="709" class="Symbol">;</a> <a id="711" href="../code/fininj/Agda.Builtin.Unit.html#137" class="Record">⊤</a><a id="712" class="Symbol">)</a>
<a id="714" class="Keyword">open</a> <a id="719" class="Keyword">import</a> <a id="726" href="../code/fininj/Function.html" class="Module">Function</a>                              <a id="764" class="Keyword">using</a> <a id="770" class="Symbol">(</a><a id="771" href="../code/fininj/Function.Base.html#992" class="../code/fininj/Function Operator">_∘_</a><a id="774" class="Symbol">;</a> <a id="776" href="../code/fininj/Function.Base.html#615" class="../code/fininj/Function">id</a><a id="778" class="Symbol">;</a> <a id="780" href="../code/fininj/Function.Base.html#3828" class="../code/fininj/Function Operator">_⟨_⟩_</a><a id="785" class="Symbol">)</a>
<a id="787" class="Keyword">open</a> <a id="792" class="Keyword">import</a> <a id="799" href="../code/fininj/Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="837" class="Keyword">using</a> <a id="843" class="Symbol">(</a><a id="844" href="../code/fininj/Relation.Binary.PropositionalEquality.Core.html#1076" class="../code/fininj/Function">subst</a><a id="849" class="Symbol">;</a> <a id="851" href="../code/fininj/Relation.Binary.PropositionalEquality.Core.html#1025" class="../code/fininj/Function">trans</a><a id="856" class="Symbol">;</a> <a id="858" href="../code/fininj/Relation.Binary.PropositionalEquality.Core.html#1131" class="../code/fininj/Function">cong</a><a id="862" class="Symbol">;</a> <a id="864" href="../code/fininj/Relation.Binary.PropositionalEquality.Core.html#980" class="../code/fininj/Function">sym</a><a id="867" class="Symbol">;</a> <a id="869" href="../code/fininj/Agda.Builtin.Equality.html#125" class="Datatype Operator">_≡_</a><a id="872" class="Symbol">;</a> <a id="874" href="../code/fininj/Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a><a id="878" class="Symbol">;</a> <a id="880" href="../code/fininj/Relation.Binary.PropositionalEquality.Core.html#840" class="../code/fininj/Function Operator">_≢_</a><a id="883" class="Symbol">)</a>
<a id="885" class="Keyword">open</a> <a id="890" class="Keyword">import</a> <a id="897" href="../code/fininj/Data.Empty.html" class="Module">Data.Empty</a>                            <a id="935" class="Keyword">using</a> <a id="941" class="Symbol">(</a><a id="942" href="../code/fininj/Data.Empty.html#275" class="../code/fininj/Function">⊥-elim</a><a id="948" class="Symbol">;</a> <a id="950" href="../code/fininj/Data.Empty.html#260" class="Datatype">⊥</a><a id="951" class="Symbol">)</a>

<a id="954" class="Keyword">variable</a> <a id="963" href="#963" class="Generalizable">n</a> <a id="965" href="#965" class="Generalizable">m</a> <a id="967" class="Symbol">:</a> <a id="969" href="../code/fininj/Agda.Builtin.Nat.html#165" class="Datatype">ℕ</a>
</pre>
</details>
<p>Here’s a puzzle: can you prove that <code>Fin</code> is injective? That’s the type constructor, by the way, not the type itself. Here’s the type of the proof we want:</p>
<pre class="Agda"><a id="Goal"></a><a id="1153" href="#1153" class="../code/fininj/Function">Goal</a> <a id="1158" class="Symbol">:</a> <a id="1160" class="PrimitiveType">Set₁</a>
<a id="1165" href="#1153" class="../code/fininj/Function">Goal</a> <a id="1170" class="Symbol">=</a> <a id="1172" class="Symbol">∀</a> <a id="1174" class="Symbol">{</a><a id="1175" href="#1175" class="Bound">n</a> <a id="1177" href="#1177" class="Bound">m</a><a id="1178" class="Symbol">}</a> <a id="1180" class="Symbol">→</a> <a id="1182" href="../code/fininj/Data.Fin.Base.html#1061" class="Datatype">Fin</a> <a id="1186" href="#1175" class="Bound">n</a> <a id="1188" href="../code/fininj/Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="1190" href="../code/fininj/Data.Fin.Base.html#1061" class="Datatype">Fin</a> <a id="1194" href="#1177" class="Bound">m</a> <a id="1196" class="Symbol">→</a> <a id="1198" href="#1175" class="Bound">n</a> <a id="1200" href="../code/fininj/Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="1202" href="#1177" class="Bound">m</a>
</pre>
<p>I’m going to present a proof of this lemma that has a couple interesting features. You should try it yourself before reading on, though: it’s difficult, but great practice for understanding Agda’s type system.</p>
<p>First off, I should say that it’s not really a “new” proof: it’s basically <a href="https://github.com/AndrasKovacs/misc-stuff/blob/db1b6f8699870ba25986c5408f1dddbded663b7c/agda/FinInj.agda">Andras Kovac’s proof</a>, with one key change. That proof, as well as this one, goes <code>--without-K</code>: because I actually use this proof in some work I’m doing in Cubical Agda at the moment, this was non optional. It does make things significantly harder, and disallows nice tricks like the <a href="https://github.com/effectfully/random-stuff/blob/8907dda8cbba29073e6c9720e9b05f47be864440/Fin-injective.agda">ones used by effectfully</a>.</p>
<h1 id="computational-inequalities">Computational Inequalities</h1>
<p>The trick we’re going to use comes courtesy of <a href="https://personal.cis.strath.ac.uk/james.wood.100/blog/html/VecMat.html">James Wood</a>. The central idea is the following type:</p>
<pre class="Agda"><a id="_≢ᶠ_"></a><a id="2239" href="#2239" class="../code/fininj/Function Operator">_≢ᶠ_</a> <a id="2244" class="Symbol">:</a> <a id="2246" href="../code/fininj/Data.Fin.Base.html#1061" class="Datatype">Fin</a> <a id="2250" href="#963" class="Generalizable">n</a> <a id="2252" class="Symbol">→</a> <a id="2254" href="../code/fininj/Data.Fin.Base.html#1061" class="Datatype">Fin</a> <a id="2258" href="#963" class="Generalizable">n</a> <a id="2260" class="Symbol">→</a> <a id="2262" class="PrimitiveType">Set</a>
<a id="2266" href="#2266" class="Bound">x</a> <a id="2268" href="#2239" class="../code/fininj/Function Operator">≢ᶠ</a> <a id="2271" href="#2271" class="Bound">y</a> <a id="2273" class="Symbol">=</a> <a id="2275" href="../code/fininj/Data.Bool.Base.html#1451" class="../code/fininj/Function">T</a> <a id="2277" class="Symbol">(</a><a id="2278" href="../code/fininj/Data.Bool.Base.html#932" class="../code/fininj/Function">not</a> <a id="2282" class="Symbol">(</a><a id="2283" href="../code/fininj/Relation.Nullary.html#1578" class="Field">does</a> <a id="2288" class="Symbol">(</a><a id="2289" href="#2266" class="Bound">x</a> <a id="2291" href="../code/fininj/Data.Fin.Properties.html#1997" class="../code/fininj/Function Operator">≟</a> <a id="2293" href="#2271" class="Bound">y</a><a id="2294" class="Symbol">)))</a>
</pre>
<p>This proof of inequality of <code>Fin</code>s is different from the usual definition, which might be something like:</p>
<pre class="Agda"><a id="_≢ᶠ′_"></a><a id="2418" href="#2418" class="../code/fininj/Function Operator">_≢ᶠ′_</a> <a id="2424" class="Symbol">:</a> <a id="2426" href="../code/fininj/Data.Fin.Base.html#1061" class="Datatype">Fin</a> <a id="2430" href="#963" class="Generalizable">n</a> <a id="2432" class="Symbol">→</a> <a id="2434" href="../code/fininj/Data.Fin.Base.html#1061" class="Datatype">Fin</a> <a id="2438" href="#963" class="Generalizable">n</a> <a id="2440" class="Symbol">→</a> <a id="2442" class="PrimitiveType">Set</a>
<a id="2446" href="#2446" class="Bound">x</a> <a id="2448" href="#2418" class="../code/fininj/Function Operator">≢ᶠ′</a> <a id="2452" href="#2452" class="Bound">y</a> <a id="2454" class="Symbol">=</a> <a id="2456" href="#2446" class="Bound">x</a> <a id="2458" href="../code/fininj/Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="2460" href="#2452" class="Bound">y</a> <a id="2462" class="Symbol">→</a> <a id="2464" href="../code/fininj/Data.Empty.html#260" class="Datatype">⊥</a>
</pre>
<p>Our definition is based on the decidable equality of two <code>Fin</code>s. It also uses the standard library’s new <code>Dec</code> type. Basically, we get better computation behaviour from our definition. It behaves as if it were defined like so:</p>
<pre class="Agda"><a id="_≢ᶠ″_"></a><a id="2707" href="#2707" class="../code/fininj/Function Operator">_≢ᶠ″_</a> <a id="2713" class="Symbol">:</a> <a id="2715" href="../code/fininj/Data.Fin.Base.html#1061" class="Datatype">Fin</a> <a id="2719" href="#963" class="Generalizable">n</a> <a id="2721" class="Symbol">→</a> <a id="2723" href="../code/fininj/Data.Fin.Base.html#1061" class="Datatype">Fin</a> <a id="2727" href="#963" class="Generalizable">n</a> <a id="2729" class="Symbol">→</a> <a id="2731" class="PrimitiveType">Set</a>
<a id="2735" href="../code/fininj/Data.Fin.Base.html#1083" class="InductiveConstructor">zero</a>  <a id="2741" href="#2707" class="../code/fininj/Function Operator">≢ᶠ″</a> <a id="2745" href="../code/fininj/Data.Fin.Base.html#1083" class="InductiveConstructor">zero</a>  <a id="2751" class="Symbol">=</a> <a id="2753" href="../code/fininj/Data.Empty.html#260" class="Datatype">⊥</a>
<a id="2755" href="../code/fininj/Data.Fin.Base.html#1083" class="InductiveConstructor">zero</a>  <a id="2761" href="#2707" class="../code/fininj/Function Operator">≢ᶠ″</a> <a id="2765" href="../code/fininj/Data.Fin.Base.html#1114" class="InductiveConstructor">suc</a> <a id="2769" href="#2769" class="Bound">y</a> <a id="2771" class="Symbol">=</a> <a id="2773" href="../code/fininj/Agda.Builtin.Unit.html#137" class="Record">⊤</a>
<a id="2775" href="../code/fininj/Data.Fin.Base.html#1114" class="InductiveConstructor">suc</a> <a id="2779" href="#2779" class="Bound">x</a> <a id="2781" href="#2707" class="../code/fininj/Function Operator">≢ᶠ″</a> <a id="2785" href="../code/fininj/Data.Fin.Base.html#1083" class="InductiveConstructor">zero</a>  <a id="2791" class="Symbol">=</a> <a id="2793" href="../code/fininj/Agda.Builtin.Unit.html#137" class="Record">⊤</a>
<a id="2795" href="../code/fininj/Data.Fin.Base.html#1114" class="InductiveConstructor">suc</a> <a id="2799" href="#2799" class="Bound">x</a> <a id="2801" href="#2707" class="../code/fininj/Function Operator">≢ᶠ″</a> <a id="2805" href="../code/fininj/Data.Fin.Base.html#1114" class="InductiveConstructor">suc</a> <a id="2809" href="#2809" class="Bound">y</a> <a id="2811" class="Symbol">=</a> <a id="2813" href="#2799" class="Bound">x</a> <a id="2815" href="#2707" class="../code/fininj/Function Operator">≢ᶠ″</a> <a id="2819" href="#2809" class="Bound">y</a>
</pre>
<p>The benefit of this, in contrast to <code>_≢ᶠ′_</code>, is that each case becomes a definitional equality we don’t have to prove. Compare the two following proofs of congruence under <code>suc</code>:</p>
<pre class="Agda"><a id="cong-suc″"></a><a id="3014" href="#3014" class="../code/fininj/Function">cong-suc″</a> <a id="3024" class="Symbol">:</a> <a id="3026" class="Symbol">∀</a> <a id="3028" class="Symbol">{</a><a id="3029" href="#3029" class="Bound">x</a> <a id="3031" href="#3031" class="Bound">y</a> <a id="3033" class="Symbol">:</a> <a id="3035" href="../code/fininj/Data.Fin.Base.html#1061" class="Datatype">Fin</a> <a id="3039" href="#963" class="Generalizable">n</a><a id="3040" class="Symbol">}</a> <a id="3042" class="Symbol">→</a> <a id="3044" href="#3029" class="Bound">x</a> <a id="3046" href="#2707" class="../code/fininj/Function Operator">≢ᶠ″</a> <a id="3050" href="#3031" class="Bound">y</a> <a id="3052" class="Symbol">→</a> <a id="3054" href="../code/fininj/Data.Fin.Base.html#1114" class="InductiveConstructor">suc</a> <a id="3058" href="#3029" class="Bound">x</a> <a id="3060" href="#2707" class="../code/fininj/Function Operator">≢ᶠ″</a> <a id="3064" href="../code/fininj/Data.Fin.Base.html#1114" class="InductiveConstructor">suc</a> <a id="3068" href="#3031" class="Bound">y</a>
<a id="3070" href="#3014" class="../code/fininj/Function">cong-suc″</a> <a id="3080" href="#3080" class="Bound">p</a> <a id="3082" class="Symbol">=</a> <a id="3084" href="#3080" class="Bound">p</a>

<a id="cong-suc′"></a><a id="3087" href="#3087" class="../code/fininj/Function">cong-suc′</a> <a id="3097" class="Symbol">:</a> <a id="3099" class="Symbol">∀</a> <a id="3101" class="Symbol">{</a><a id="3102" href="#3102" class="Bound">x</a> <a id="3104" href="#3104" class="Bound">y</a> <a id="3106" class="Symbol">:</a> <a id="3108" href="../code/fininj/Data.Fin.Base.html#1061" class="Datatype">Fin</a> <a id="3112" href="#963" class="Generalizable">n</a><a id="3113" class="Symbol">}</a> <a id="3115" class="Symbol">→</a> <a id="3117" href="#3102" class="Bound">x</a> <a id="3119" href="#2418" class="../code/fininj/Function Operator">≢ᶠ′</a> <a id="3123" href="#3104" class="Bound">y</a> <a id="3125" class="Symbol">→</a> <a id="3127" href="../code/fininj/Data.Fin.Base.html#1114" class="InductiveConstructor">suc</a> <a id="3131" href="#3102" class="Bound">x</a> <a id="3133" href="#2418" class="../code/fininj/Function Operator">≢ᶠ′</a> <a id="3137" href="../code/fininj/Data.Fin.Base.html#1114" class="InductiveConstructor">suc</a> <a id="3141" href="#3104" class="Bound">y</a>
<a id="3143" href="#3087" class="../code/fininj/Function">cong-suc′</a> <a id="3153" class="Symbol">{</a><a id="3154" class="Argument">n</a> <a id="3156" class="Symbol">=</a> <a id="3158" href="../code/fininj/Agda.Builtin.Nat.html#196" class="InductiveConstructor">suc</a> <a id="3162" href="#3162" class="Bound">n</a><a id="3163" class="Symbol">}</a> <a id="3165" href="#3165" class="Bound">p</a> <a id="3167" href="#3167" class="Bound">q</a> <a id="3169" class="Symbol">=</a> <a id="3171" href="#3165" class="Bound">p</a> <a id="3173" class="Symbol">(</a><a id="3174" href="../code/fininj/Relation.Binary.PropositionalEquality.Core.html#1131" class="../code/fininj/Function">cong</a> <a id="3179" href="#3198" class="../code/fininj/Function">fpred</a> <a id="3185" href="#3167" class="Bound">q</a><a id="3186" class="Symbol">)</a>
  <a id="3190" class="Keyword">where</a>
  <a id="3198" href="#3198" class="../code/fininj/Function">fpred</a> <a id="3204" class="Symbol">:</a> <a id="3206" href="../code/fininj/Data.Fin.Base.html#1061" class="Datatype">Fin</a> <a id="3210" class="Symbol">(</a><a id="3211" href="../code/fininj/Agda.Builtin.Nat.html#196" class="InductiveConstructor">suc</a> <a id="3215" class="Symbol">(</a><a id="3216" href="../code/fininj/Agda.Builtin.Nat.html#196" class="InductiveConstructor">suc</a> <a id="3220" href="#3162" class="Bound">n</a><a id="3221" class="Symbol">))</a> <a id="3224" class="Symbol">→</a> <a id="3226" href="../code/fininj/Data.Fin.Base.html#1061" class="Datatype">Fin</a> <a id="3230" class="Symbol">(</a><a id="3231" href="../code/fininj/Agda.Builtin.Nat.html#196" class="InductiveConstructor">suc</a> <a id="3235" href="#3162" class="Bound">n</a><a id="3236" class="Symbol">)</a>
  <a id="3240" href="#3198" class="../code/fininj/Function">fpred</a> <a id="3246" class="Symbol">(</a><a id="3247" href="../code/fininj/Data.Fin.Base.html#1114" class="InductiveConstructor">suc</a> <a id="3251" href="#3251" class="Bound">x</a><a id="3252" class="Symbol">)</a> <a id="3254" class="Symbol">=</a> <a id="3256" href="#3251" class="Bound">x</a>
  <a id="3260" href="#3198" class="../code/fininj/Function">fpred</a> <a id="3266" href="../code/fininj/Data.Fin.Base.html#1083" class="InductiveConstructor">zero</a> <a id="3271" class="Symbol">=</a> <a id="3273" href="../code/fininj/Data.Fin.Base.html#1083" class="InductiveConstructor">zero</a>
</pre>
<h1 id="the-proof">The Proof</h1>
<p>First, we will describe an “injection” for functions from <code>Fin</code>s to <code>Fin</code>s.</p>
<pre class="Agda"><a id="_F↣_"></a><a id="3381" href="#3381" class="../code/fininj/Function Operator">_F↣_</a> <a id="3386" class="Symbol">:</a> <a id="3388" href="../code/fininj/Agda.Builtin.Nat.html#165" class="Datatype">ℕ</a> <a id="3390" class="Symbol">→</a> <a id="3392" href="../code/fininj/Agda.Builtin.Nat.html#165" class="Datatype">ℕ</a> <a id="3394" class="Symbol">→</a> <a id="3396" class="PrimitiveType">Set</a>
<a id="3400" href="#3400" class="Bound">n</a> <a id="3402" href="#3381" class="../code/fininj/Function Operator">F↣</a> <a id="3405" href="#3405" class="Bound">m</a> <a id="3407" class="Symbol">=</a> <a id="3409" href="../code/fininj/Data.Product.html#916" class="../code/fininj/Function">Σ[</a> <a id="3412" href="#3412" class="Bound">f</a> <a id="3414" href="../code/fininj/Data.Product.html#916" class="../code/fininj/Function">∈</a> <a id="3416" class="Symbol">(</a><a id="3417" href="../code/fininj/Data.Fin.Base.html#1061" class="Datatype">Fin</a> <a id="3421" href="#3400" class="Bound">n</a> <a id="3423" class="Symbol">→</a> <a id="3425" href="../code/fininj/Data.Fin.Base.html#1061" class="Datatype">Fin</a> <a id="3429" href="#3405" class="Bound">m</a><a id="3430" class="Symbol">)</a> <a id="3432" href="../code/fininj/Data.Product.html#916" class="../code/fininj/Function">]</a> <a id="3434" class="Symbol">∀</a> <a id="3436" class="Symbol">{</a><a id="3437" href="#3437" class="Bound">x</a> <a id="3439" href="#3439" class="Bound">y</a><a id="3440" class="Symbol">}</a> <a id="3442" class="Symbol">→</a> <a id="3444" href="#3437" class="Bound">x</a> <a id="3446" href="#2239" class="../code/fininj/Function Operator">≢ᶠ</a> <a id="3449" href="#3439" class="Bound">y</a> <a id="3451" class="Symbol">→</a> <a id="3453" href="#3412" class="Bound">f</a> <a id="3455" href="#3437" class="Bound">x</a> <a id="3457" href="#2239" class="../code/fininj/Function Operator">≢ᶠ</a> <a id="3460" href="#3412" class="Bound">f</a> <a id="3462" href="#3439" class="Bound">y</a>
</pre>
<p>We’re using the negated from of injectivity here, which is usually avoided in constructive settings. It actually works a little better for us here, though. Since we’re working in the domain of <code>Fin</code>s, and since our proof is prop-valued, it’s almost like we’re working in classical logic.</p>
<p>Next, we have the workhorse of the proof, the <code>shrink</code> lemma:</p>
<pre class="Agda"><a id="shift"></a><a id="3829" href="#3829" class="../code/fininj/Function">shift</a> <a id="3835" class="Symbol">:</a> <a id="3837" class="Symbol">(</a><a id="3838" href="#3838" class="Bound">x</a> <a id="3840" href="#3840" class="Bound">y</a> <a id="3842" class="Symbol">:</a> <a id="3844" href="../code/fininj/Data.Fin.Base.html#1061" class="Datatype">Fin</a> <a id="3848" class="Symbol">(</a><a id="3849" href="../code/fininj/Agda.Builtin.Nat.html#196" class="InductiveConstructor">suc</a> <a id="3853" href="#963" class="Generalizable">n</a><a id="3854" class="Symbol">))</a> <a id="3857" class="Symbol">→</a> <a id="3859" href="#3838" class="Bound">x</a> <a id="3861" href="#2239" class="../code/fininj/Function Operator">≢ᶠ</a> <a id="3864" href="#3840" class="Bound">y</a> <a id="3866" class="Symbol">→</a> <a id="3868" href="../code/fininj/Data.Fin.Base.html#1061" class="Datatype">Fin</a> <a id="3872" href="#963" class="Generalizable">n</a>
<a id="3874" href="#3829" class="../code/fininj/Function">shift</a>         <a id="3888" href="../code/fininj/Data.Fin.Base.html#1083" class="InductiveConstructor">zero</a>    <a id="3896" class="Symbol">(</a><a id="3897" href="../code/fininj/Data.Fin.Base.html#1114" class="InductiveConstructor">suc</a> <a id="3901" href="#3901" class="Bound">y</a><a id="3902" class="Symbol">)</a> <a id="3904" href="#3904" class="Bound">x≢y</a> <a id="3908" class="Symbol">=</a> <a id="3910" href="#3901" class="Bound">y</a>
<a id="3912" href="#3829" class="../code/fininj/Function">shift</a> <a id="3918" class="Symbol">{</a><a id="3919" href="../code/fininj/Agda.Builtin.Nat.html#196" class="InductiveConstructor">suc</a> <a id="3923" class="Symbol">_}</a> <a id="3926" class="Symbol">(</a><a id="3927" href="../code/fininj/Data.Fin.Base.html#1114" class="InductiveConstructor">suc</a> <a id="3931" href="#3931" class="Bound">x</a><a id="3932" class="Symbol">)</a> <a id="3934" href="../code/fininj/Data.Fin.Base.html#1083" class="InductiveConstructor">zero</a>    <a id="3942" href="#3942" class="Bound">x≢y</a> <a id="3946" class="Symbol">=</a> <a id="3948" href="../code/fininj/Data.Fin.Base.html#1083" class="InductiveConstructor">zero</a>
<a id="3953" href="#3829" class="../code/fininj/Function">shift</a> <a id="3959" class="Symbol">{</a><a id="3960" href="../code/fininj/Agda.Builtin.Nat.html#196" class="InductiveConstructor">suc</a> <a id="3964" class="Symbol">_}</a> <a id="3967" class="Symbol">(</a><a id="3968" href="../code/fininj/Data.Fin.Base.html#1114" class="InductiveConstructor">suc</a> <a id="3972" href="#3972" class="Bound">x</a><a id="3973" class="Symbol">)</a> <a id="3975" class="Symbol">(</a><a id="3976" href="../code/fininj/Data.Fin.Base.html#1114" class="InductiveConstructor">suc</a> <a id="3980" href="#3980" class="Bound">y</a><a id="3981" class="Symbol">)</a> <a id="3983" href="#3983" class="Bound">x≢y</a> <a id="3987" class="Symbol">=</a> <a id="3989" href="../code/fininj/Data.Fin.Base.html#1114" class="InductiveConstructor">suc</a> <a id="3993" class="Symbol">(</a><a id="3994" href="#3829" class="../code/fininj/Function">shift</a> <a id="4000" href="#3972" class="Bound">x</a> <a id="4002" href="#3980" class="Bound">y</a> <a id="4004" href="#3983" class="Bound">x≢y</a><a id="4007" class="Symbol">)</a>

<a id="shift-inj"></a><a id="4010" href="#4010" class="../code/fininj/Function">shift-inj</a> <a id="4020" class="Symbol">:</a> <a id="4022" class="Symbol">∀</a> <a id="4024" class="Symbol">(</a><a id="4025" href="#4025" class="Bound">x</a> <a id="4027" href="#4027" class="Bound">y</a> <a id="4029" href="#4029" class="Bound">z</a> <a id="4031" class="Symbol">:</a> <a id="4033" href="../code/fininj/Data.Fin.Base.html#1061" class="Datatype">Fin</a> <a id="4037" class="Symbol">(</a><a id="4038" href="../code/fininj/Agda.Builtin.Nat.html#196" class="InductiveConstructor">suc</a> <a id="4042" href="#963" class="Generalizable">n</a><a id="4043" class="Symbol">))</a> <a id="4046" href="#4046" class="Bound">y≢x</a> <a id="4050" href="#4050" class="Bound">z≢x</a> <a id="4054" class="Symbol">→</a> <a id="4056" href="#4027" class="Bound">y</a> <a id="4058" href="#2239" class="../code/fininj/Function Operator">≢ᶠ</a> <a id="4061" href="#4029" class="Bound">z</a> <a id="4063" class="Symbol">→</a> <a id="4065" href="#3829" class="../code/fininj/Function">shift</a> <a id="4071" href="#4025" class="Bound">x</a> <a id="4073" href="#4027" class="Bound">y</a> <a id="4075" href="#4046" class="Bound">y≢x</a> <a id="4079" href="#2239" class="../code/fininj/Function Operator">≢ᶠ</a> <a id="4082" href="#3829" class="../code/fininj/Function">shift</a> <a id="4088" href="#4025" class="Bound">x</a> <a id="4090" href="#4029" class="Bound">z</a> <a id="4092" href="#4050" class="Bound">z≢x</a>
<a id="4096" href="#4010" class="../code/fininj/Function">shift-inj</a>         <a id="4114" href="../code/fininj/Data.Fin.Base.html#1083" class="InductiveConstructor">zero</a>    <a id="4122" class="Symbol">(</a><a id="4123" href="../code/fininj/Data.Fin.Base.html#1114" class="InductiveConstructor">suc</a> <a id="4127" href="#4127" class="Bound">y</a><a id="4128" class="Symbol">)</a> <a id="4130" class="Symbol">(</a><a id="4131" href="../code/fininj/Data.Fin.Base.html#1114" class="InductiveConstructor">suc</a> <a id="4135" href="#4135" class="Bound">z</a><a id="4136" class="Symbol">)</a> <a id="4138" href="#4138" class="Bound">y≢x</a> <a id="4142" href="#4142" class="Bound">z≢x</a> <a id="4146" href="#4146" class="Bound">neq</a> <a id="4150" class="Symbol">=</a> <a id="4152" href="#4146" class="Bound">neq</a>
<a id="4156" href="#4010" class="../code/fininj/Function">shift-inj</a> <a id="4166" class="Symbol">{</a><a id="4167" href="../code/fininj/Agda.Builtin.Nat.html#196" class="InductiveConstructor">suc</a> <a id="4171" class="Symbol">_}</a> <a id="4174" class="Symbol">(</a><a id="4175" href="../code/fininj/Data.Fin.Base.html#1114" class="InductiveConstructor">suc</a> <a id="4179" href="#4179" class="Bound">x</a><a id="4180" class="Symbol">)</a> <a id="4182" href="../code/fininj/Data.Fin.Base.html#1083" class="InductiveConstructor">zero</a>    <a id="4190" class="Symbol">(</a><a id="4191" href="../code/fininj/Data.Fin.Base.html#1114" class="InductiveConstructor">suc</a> <a id="4195" href="#4195" class="Bound">z</a><a id="4196" class="Symbol">)</a> <a id="4198" href="#4198" class="Bound">y≢x</a> <a id="4202" href="#4202" class="Bound">z≢x</a> <a id="4206" href="#4206" class="Bound">neq</a> <a id="4210" class="Symbol">=</a> <a id="4212" href="../code/fininj/Agda.Builtin.Unit.html#174" class="InductiveConstructor">tt</a>
<a id="4215" href="#4010" class="../code/fininj/Function">shift-inj</a> <a id="4225" class="Symbol">{</a><a id="4226" href="../code/fininj/Agda.Builtin.Nat.html#196" class="InductiveConstructor">suc</a> <a id="4230" class="Symbol">_}</a> <a id="4233" class="Symbol">(</a><a id="4234" href="../code/fininj/Data.Fin.Base.html#1114" class="InductiveConstructor">suc</a> <a id="4238" href="#4238" class="Bound">x</a><a id="4239" class="Symbol">)</a> <a id="4241" class="Symbol">(</a><a id="4242" href="../code/fininj/Data.Fin.Base.html#1114" class="InductiveConstructor">suc</a> <a id="4246" href="#4246" class="Bound">y</a><a id="4247" class="Symbol">)</a> <a id="4249" href="../code/fininj/Data.Fin.Base.html#1083" class="InductiveConstructor">zero</a>    <a id="4257" href="#4257" class="Bound">y≢x</a> <a id="4261" href="#4261" class="Bound">z≢x</a> <a id="4265" href="#4265" class="Bound">neq</a> <a id="4269" class="Symbol">=</a> <a id="4271" href="../code/fininj/Agda.Builtin.Unit.html#174" class="InductiveConstructor">tt</a>
<a id="4274" href="#4010" class="../code/fininj/Function">shift-inj</a> <a id="4284" class="Symbol">{</a><a id="4285" href="../code/fininj/Agda.Builtin.Nat.html#196" class="InductiveConstructor">suc</a> <a id="4289" class="Symbol">_}</a> <a id="4292" class="Symbol">(</a><a id="4293" href="../code/fininj/Data.Fin.Base.html#1114" class="InductiveConstructor">suc</a> <a id="4297" href="#4297" class="Bound">x</a><a id="4298" class="Symbol">)</a> <a id="4300" class="Symbol">(</a><a id="4301" href="../code/fininj/Data.Fin.Base.html#1114" class="InductiveConstructor">suc</a> <a id="4305" href="#4305" class="Bound">y</a><a id="4306" class="Symbol">)</a> <a id="4308" class="Symbol">(</a><a id="4309" href="../code/fininj/Data.Fin.Base.html#1114" class="InductiveConstructor">suc</a> <a id="4313" href="#4313" class="Bound">z</a><a id="4314" class="Symbol">)</a> <a id="4316" href="#4316" class="Bound">y≢x</a> <a id="4320" href="#4320" class="Bound">z≢x</a> <a id="4324" href="#4324" class="Bound">neq</a> <a id="4328" class="Symbol">=</a> <a id="4330" href="#4010" class="../code/fininj/Function">shift-inj</a> <a id="4340" href="#4297" class="Bound">x</a> <a id="4342" href="#4305" class="Bound">y</a> <a id="4344" href="#4313" class="Bound">z</a> <a id="4346" href="#4316" class="Bound">y≢x</a> <a id="4350" href="#4320" class="Bound">z≢x</a> <a id="4354" href="#4324" class="Bound">neq</a>

<a id="shrink"></a><a id="4359" href="#4359" class="../code/fininj/Function">shrink</a> <a id="4366" class="Symbol">:</a> <a id="4368" href="../code/fininj/Agda.Builtin.Nat.html#196" class="InductiveConstructor">suc</a> <a id="4372" href="#963" class="Generalizable">n</a> <a id="4374" href="#3381" class="../code/fininj/Function Operator">F↣</a> <a id="4377" href="../code/fininj/Agda.Builtin.Nat.html#196" class="InductiveConstructor">suc</a> <a id="4381" href="#965" class="Generalizable">m</a> <a id="4383" class="Symbol">→</a> <a id="4385" href="#963" class="Generalizable">n</a> <a id="4387" href="#3381" class="../code/fininj/Function Operator">F↣</a> <a id="4390" href="#965" class="Generalizable">m</a>
<a id="4392" href="#4359" class="../code/fininj/Function">shrink</a> <a id="4399" class="Symbol">(</a><a id="4400" href="#4400" class="Bound">f</a> <a id="4402" href="../code/fininj/Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="4404" href="#4404" class="Bound">inj</a><a id="4407" class="Symbol">)</a> <a id="4409" class="Symbol">.</a><a id="4410" href="../code/fininj/Agda.Builtin.Sigma.html#225" class="Field">proj₁</a> <a id="4416" href="#4416" class="Bound">x</a> <a id="4418" class="Symbol">=</a> <a id="4420" href="#3829" class="../code/fininj/Function">shift</a> <a id="4426" class="Symbol">(</a><a id="4427" href="#4400" class="Bound">f</a> <a id="4429" href="../code/fininj/Data.Fin.Base.html#1083" class="InductiveConstructor">zero</a><a id="4433" class="Symbol">)</a> <a id="4435" class="Symbol">(</a><a id="4436" href="#4400" class="Bound">f</a> <a id="4438" class="Symbol">(</a><a id="4439" href="../code/fininj/Data.Fin.Base.html#1114" class="InductiveConstructor">suc</a> <a id="4443" href="#4416" class="Bound">x</a><a id="4444" class="Symbol">))</a> <a id="4447" class="Symbol">(</a><a id="4448" href="#4404" class="Bound">inj</a> <a id="4452" href="../code/fininj/Agda.Builtin.Unit.html#174" class="InductiveConstructor">tt</a><a id="4454" class="Symbol">)</a>
<a id="4456" href="#4359" class="../code/fininj/Function">shrink</a> <a id="4463" class="Symbol">(</a><a id="4464" href="#4464" class="Bound">f</a> <a id="4466" href="../code/fininj/Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="4468" href="#4468" class="Bound">inj</a><a id="4471" class="Symbol">)</a> <a id="4473" class="Symbol">.</a><a id="4474" href="../code/fininj/Agda.Builtin.Sigma.html#237" class="Field">proj₂</a> <a id="4480" href="#4480" class="Bound">p</a> <a id="4482" class="Symbol">=</a> <a id="4484" href="#4010" class="../code/fininj/Function">shift-inj</a> <a id="4494" class="Symbol">(</a><a id="4495" href="#4464" class="Bound">f</a> <a id="4497" href="../code/fininj/Data.Fin.Base.html#1083" class="InductiveConstructor">zero</a><a id="4501" class="Symbol">)</a> <a id="4503" class="Symbol">(</a><a id="4504" href="#4464" class="Bound">f</a> <a id="4506" class="Symbol">(</a><a id="4507" href="../code/fininj/Data.Fin.Base.html#1114" class="InductiveConstructor">suc</a> <a id="4511" class="Symbol">_))</a> <a id="4515" class="Symbol">(</a><a id="4516" href="#4464" class="Bound">f</a> <a id="4518" class="Symbol">(</a><a id="4519" href="../code/fininj/Data.Fin.Base.html#1114" class="InductiveConstructor">suc</a> <a id="4523" class="Symbol">_))</a> <a id="4527" class="Symbol">(</a><a id="4528" href="#4468" class="Bound">inj</a> <a id="4532" href="../code/fininj/Agda.Builtin.Unit.html#174" class="InductiveConstructor">tt</a><a id="4534" class="Symbol">)</a> <a id="4536" class="Symbol">(</a><a id="4537" href="#4468" class="Bound">inj</a> <a id="4541" href="../code/fininj/Agda.Builtin.Unit.html#174" class="InductiveConstructor">tt</a><a id="4543" class="Symbol">)</a> <a id="4545" class="Symbol">(</a><a id="4546" href="#4468" class="Bound">inj</a> <a id="4550" href="#4480" class="Bound">p</a><a id="4551" class="Symbol">)</a>
</pre>
<p>This will give us the inductive step for the overall proof. Notice the absence of any <code>cong</code>s or the like: the computation behaviour of <code>≢ᶠ</code> saves us on that particular front. Also we don’t have to use <code>⊥-elim</code> at any point: again, because of the computation behaviour of <code>≢ᶠ</code>, Agda knows that certain cases are unreachable, so we don’t even have to define them.</p>
<p>Next, we derive the proof that a <code>Fin</code> cannot inject into a smaller <code>Fin</code>.</p>
<pre class="Agda"><a id="¬plus-inj"></a><a id="5006" href="#5006" class="../code/fininj/Function">¬plus-inj</a> <a id="5016" class="Symbol">:</a> <a id="5018" class="Symbol">∀</a> <a id="5020" href="#5020" class="Bound">n</a> <a id="5022" href="#5022" class="Bound">m</a> <a id="5024" class="Symbol">→</a> <a id="5026" href="../code/fininj/Relation.Nullary.html#653" class="../code/fininj/Function Operator">¬</a> <a id="5028" class="Symbol">(</a><a id="5029" href="../code/fininj/Agda.Builtin.Nat.html#196" class="InductiveConstructor">suc</a> <a id="5033" class="Symbol">(</a><a id="5034" href="#5020" class="Bound">n</a> <a id="5036" href="../code/fininj/Agda.Builtin.Nat.html#298" class="Primitive Operator">+</a> <a id="5038" href="#5022" class="Bound">m</a><a id="5039" class="Symbol">)</a> <a id="5041" href="#3381" class="../code/fininj/Function Operator">F↣</a> <a id="5044" href="#5022" class="Bound">m</a><a id="5045" class="Symbol">)</a>
<a id="5047" href="#5006" class="../code/fininj/Function">¬plus-inj</a> <a id="5057" href="../code/fininj/Agda.Builtin.Nat.html#183" class="InductiveConstructor">zero</a>    <a id="5065" class="Symbol">(</a><a id="5066" href="../code/fininj/Agda.Builtin.Nat.html#196" class="InductiveConstructor">suc</a> <a id="5070" href="#5070" class="Bound">m</a><a id="5071" class="Symbol">)</a> <a id="5073" href="#5073" class="Bound">inj</a>       <a id="5083" class="Symbol">=</a> <a id="5085" href="#5006" class="../code/fininj/Function">¬plus-inj</a> <a id="5095" href="../code/fininj/Agda.Builtin.Nat.html#183" class="InductiveConstructor">zero</a> <a id="5100" href="#5070" class="Bound">m</a> <a id="5102" class="Symbol">(</a><a id="5103" href="#4359" class="../code/fininj/Function">shrink</a> <a id="5110" href="#5073" class="Bound">inj</a><a id="5113" class="Symbol">)</a>
<a id="5115" href="#5006" class="../code/fininj/Function">¬plus-inj</a> <a id="5125" class="Symbol">(</a><a id="5126" href="../code/fininj/Agda.Builtin.Nat.html#196" class="InductiveConstructor">suc</a> <a id="5130" href="#5130" class="Bound">n</a><a id="5131" class="Symbol">)</a> <a id="5133" href="#5133" class="Bound">m</a>       <a id="5141" class="Symbol">(</a><a id="5142" href="#5142" class="Bound">f</a> <a id="5144" href="../code/fininj/Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="5146" href="#5146" class="Bound">inj</a><a id="5149" class="Symbol">)</a> <a id="5151" class="Symbol">=</a> <a id="5153" href="#5006" class="../code/fininj/Function">¬plus-inj</a> <a id="5163" href="#5130" class="Bound">n</a> <a id="5165" href="#5133" class="Bound">m</a> <a id="5167" class="Symbol">(</a><a id="5168" href="#5142" class="Bound">f</a> <a id="5170" href="../code/fininj/Function.Base.html#992" class="../code/fininj/Function Operator">∘</a> <a id="5172" href="../code/fininj/Data.Fin.Base.html#1114" class="InductiveConstructor">suc</a> <a id="5176" href="../code/fininj/Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="5178" href="#5146" class="Bound">inj</a><a id="5181" class="Symbol">)</a>
<a id="5183" href="#5006" class="../code/fininj/Function">¬plus-inj</a> <a id="5193" href="../code/fininj/Agda.Builtin.Nat.html#183" class="InductiveConstructor">zero</a>    <a id="5201" href="../code/fininj/Agda.Builtin.Nat.html#183" class="InductiveConstructor">zero</a>    <a id="5209" class="Symbol">(</a><a id="5210" href="#5210" class="Bound">f</a> <a id="5212" href="../code/fininj/Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="5214" class="Symbol">_)</a> <a id="5217" class="Keyword">with</a> <a id="5222" href="#5210" class="Bound">f</a> <a id="5224" href="../code/fininj/Data.Fin.Base.html#1083" class="InductiveConstructor">zero</a>
<a id="5229" class="Symbol">...</a> <a id="5233" class="Symbol">|</a> <a id="5235" class="Symbol">()</a>
</pre>
<p>That’s actually the bulk of the proof done: the rest is Lego, joining up the pieces and types. First, we give the normal definition of injectivity:</p>
<pre class="Agda"><a id="Injective"></a><a id="5400" href="#5400" class="../code/fininj/Function">Injective</a> <a id="5410" class="Symbol">:</a> <a id="5412" class="Symbol">∀</a> <a id="5414" class="Symbol">{</a><a id="5415" href="#5415" class="Bound">a</a> <a id="5417" href="#5417" class="Bound">b</a><a id="5418" class="Symbol">}</a> <a id="5420" class="Symbol">{</a><a id="5421" href="#5421" class="Bound">A</a> <a id="5423" class="Symbol">:</a> <a id="5425" class="PrimitiveType">Set</a> <a id="5429" href="#5415" class="Bound">a</a><a id="5430" class="Symbol">}</a> <a id="5432" class="Symbol">{</a><a id="5433" href="#5433" class="Bound">B</a> <a id="5435" class="Symbol">:</a> <a id="5437" class="PrimitiveType">Set</a> <a id="5441" href="#5417" class="Bound">b</a><a id="5442" class="Symbol">}</a> <a id="5444" class="Symbol">→</a> <a id="5446" class="Symbol">(</a><a id="5447" href="#5421" class="Bound">A</a> <a id="5449" class="Symbol">→</a> <a id="5451" href="#5433" class="Bound">B</a><a id="5452" class="Symbol">)</a> <a id="5454" class="Symbol">→</a> <a id="5456" class="PrimitiveType">Set</a> <a id="5460" class="Symbol">_</a>
<a id="5462" href="#5400" class="../code/fininj/Function">Injective</a> <a id="5472" href="#5472" class="Bound">f</a> <a id="5474" class="Symbol">=</a> <a id="5476" class="Symbol">∀</a> <a id="5478" class="Symbol">{</a><a id="5479" href="#5479" class="Bound">x</a> <a id="5481" href="#5481" class="Bound">y</a><a id="5482" class="Symbol">}</a> <a id="5484" class="Symbol">→</a> <a id="5486" href="#5472" class="Bound">f</a> <a id="5488" href="#5479" class="Bound">x</a> <a id="5490" href="../code/fininj/Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="5492" href="#5472" class="Bound">f</a> <a id="5494" href="#5481" class="Bound">y</a> <a id="5496" class="Symbol">→</a> <a id="5498" href="#5479" class="Bound">x</a> <a id="5500" href="../code/fininj/Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="5502" href="#5481" class="Bound">y</a>

<a id="_↣_"></a><a id="5505" href="#5505" class="../code/fininj/Function Operator">_↣_</a> <a id="5509" class="Symbol">:</a> <a id="5511" class="Symbol">∀</a> <a id="5513" class="Symbol">{</a><a id="5514" href="#5514" class="Bound">a</a> <a id="5516" href="#5516" class="Bound">b</a><a id="5517" class="Symbol">}</a> <a id="5519" class="Symbol">→</a> <a id="5521" class="PrimitiveType">Set</a> <a id="5525" href="#5514" class="Bound">a</a> <a id="5527" class="Symbol">→</a> <a id="5529" class="PrimitiveType">Set</a> <a id="5533" href="#5516" class="Bound">b</a> <a id="5535" class="Symbol">→</a> <a id="5537" class="PrimitiveType">Set</a> <a id="5541" class="Symbol">_</a>
<a id="5543" href="#5543" class="Bound">A</a> <a id="5545" href="#5505" class="../code/fininj/Function Operator">↣</a> <a id="5547" href="#5547" class="Bound">B</a> <a id="5549" class="Symbol">=</a> <a id="5551" href="../code/fininj/Agda.Builtin.Sigma.html#139" class="Record">Σ</a> <a id="5553" class="Symbol">(</a><a id="5554" href="#5543" class="Bound">A</a> <a id="5556" class="Symbol">→</a> <a id="5558" href="#5547" class="Bound">B</a><a id="5559" class="Symbol">)</a> <a id="5561" href="#5400" class="../code/fininj/Function">Injective</a>
</pre>
<p>Then we convert from one to the other:</p>
<pre class="Agda"><a id="toFin-inj"></a><a id="5624" href="#5624" class="../code/fininj/Function">toFin-inj</a> <a id="5634" class="Symbol">:</a> <a id="5636" class="Symbol">(</a><a id="5637" href="../code/fininj/Data.Fin.Base.html#1061" class="Datatype">Fin</a> <a id="5641" href="#963" class="Generalizable">n</a> <a id="5643" href="#5505" class="../code/fininj/Function Operator">↣</a> <a id="5645" href="../code/fininj/Data.Fin.Base.html#1061" class="Datatype">Fin</a> <a id="5649" href="#965" class="Generalizable">m</a><a id="5650" class="Symbol">)</a> <a id="5652" class="Symbol">→</a> <a id="5654" href="#963" class="Generalizable">n</a> <a id="5656" href="#3381" class="../code/fininj/Function Operator">F↣</a> <a id="5659" href="#965" class="Generalizable">m</a>
<a id="5661" href="#5624" class="../code/fininj/Function">toFin-inj</a> <a id="5671" href="#5671" class="Bound">f</a> <a id="5673" class="Symbol">.</a><a id="5674" href="../code/fininj/Agda.Builtin.Sigma.html#225" class="Field">proj₁</a> <a id="5680" class="Symbol">=</a> <a id="5682" href="#5671" class="Bound">f</a> <a id="5684" class="Symbol">.</a><a id="5685" href="../code/fininj/Agda.Builtin.Sigma.html#225" class="Field">proj₁</a>
<a id="5691" href="#5624" class="../code/fininj/Function">toFin-inj</a> <a id="5701" class="Symbol">(</a><a id="5702" href="#5702" class="Bound">f</a> <a id="5704" href="../code/fininj/Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="5706" href="#5706" class="Bound">inj</a><a id="5709" class="Symbol">)</a> <a id="5711" class="Symbol">.</a><a id="5712" href="../code/fininj/Agda.Builtin.Sigma.html#237" class="Field">proj₂</a> <a id="5718" class="Symbol">{</a><a id="5719" href="#5719" class="Bound">x</a><a id="5720" class="Symbol">}</a> <a id="5722" class="Symbol">{</a><a id="5723" href="#5723" class="Bound">y</a><a id="5724" class="Symbol">}</a> <a id="5726" href="#5726" class="Bound">x≢ᶠy</a> <a id="5731" class="Keyword">with</a> <a id="5736" href="#5719" class="Bound">x</a> <a id="5738" href="../code/fininj/Data.Fin.Properties.html#1997" class="../code/fininj/Function Operator">≟</a> <a id="5740" href="#5723" class="Bound">y</a> <a id="5742" class="Symbol">|</a> <a id="5744" href="#5702" class="Bound">f</a> <a id="5746" href="#5719" class="Bound">x</a> <a id="5748" href="../code/fininj/Data.Fin.Properties.html#1997" class="../code/fininj/Function Operator">≟</a> <a id="5750" href="#5702" class="Bound">f</a> <a id="5752" href="#5723" class="Bound">y</a>
<a id="5754" class="Symbol">...</a> <a id="5758" class="Symbol">|</a> <a id="5760" href="../code/fininj/Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="5763" href="#5763" class="Bound">¬p</a> <a id="5766" class="Symbol">|</a> <a id="5768" href="../code/fininj/Relation.Nullary.html#1645" class="InductiveConstructor">yes</a> <a id="5772" href="#5772" class="Bound">p</a> <a id="5774" class="Symbol">=</a> <a id="5776" href="#5763" class="Bound">¬p</a> <a id="5779" class="Symbol">(</a><a id="5780" class="Bound">inj</a> <a id="5784" href="#5772" class="Bound">p</a><a id="5785" class="Symbol">)</a>
<a id="5787" class="Symbol">...</a> <a id="5791" class="Symbol">|</a> <a id="5793" href="../code/fininj/Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="5796" class="Symbol">_</a>  <a id="5799" class="Symbol">|</a> <a id="5801" href="../code/fininj/Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="5804" class="Symbol">_</a>  <a id="5807" class="Symbol">=</a> <a id="5809" href="../code/fininj/Agda.Builtin.Unit.html#174" class="InductiveConstructor">tt</a>
</pre>
<p>And finally we have our proof:</p>
<pre class="Agda"><a id="n≢sn+m"></a><a id="5857" href="#5857" class="../code/fininj/Function">n≢sn+m</a> <a id="5864" class="Symbol">:</a> <a id="5866" class="Symbol">∀</a> <a id="5868" href="#5868" class="Bound">n</a> <a id="5870" href="#5870" class="Bound">m</a> <a id="5872" class="Symbol">→</a> <a id="5874" href="../code/fininj/Data.Fin.Base.html#1061" class="Datatype">Fin</a> <a id="5878" href="#5868" class="Bound">n</a> <a id="5880" href="../code/fininj/Relation.Binary.PropositionalEquality.Core.html#840" class="../code/fininj/Function Operator">≢</a> <a id="5882" href="../code/fininj/Data.Fin.Base.html#1061" class="Datatype">Fin</a> <a id="5886" class="Symbol">(</a><a id="5887" href="../code/fininj/Agda.Builtin.Nat.html#196" class="InductiveConstructor">suc</a> <a id="5891" class="Symbol">(</a><a id="5892" href="#5868" class="Bound">n</a> <a id="5894" href="../code/fininj/Agda.Builtin.Nat.html#298" class="Primitive Operator">+</a> <a id="5896" href="#5870" class="Bound">m</a><a id="5897" class="Symbol">))</a>
<a id="5900" href="#5857" class="../code/fininj/Function">n≢sn+m</a> <a id="5907" href="#5907" class="Bound">n</a> <a id="5909" href="#5909" class="Bound">m</a> <a id="5911" href="#5911" class="Bound">n≡m</a> <a id="5915" class="Symbol">=</a>
  <a id="5919" href="#5006" class="../code/fininj/Function">¬plus-inj</a> <a id="5929" href="#5909" class="Bound">m</a> <a id="5931" href="#5907" class="Bound">n</a> <a id="5933" class="Symbol">(</a><a id="5934" href="#5624" class="../code/fininj/Function">toFin-inj</a> <a id="5944" class="Symbol">(</a><a id="5945" href="../code/fininj/Relation.Binary.PropositionalEquality.Core.html#1076" class="../code/fininj/Function">subst</a> <a id="5951" class="Symbol">(</a><a id="5952" href="#5505" class="../code/fininj/Function Operator">_↣</a> <a id="5955" href="../code/fininj/Data.Fin.Base.html#1061" class="Datatype">Fin</a> <a id="5959" href="#5907" class="Bound">n</a><a id="5960" class="Symbol">)</a>
                             <a id="5991" class="Symbol">(</a><a id="5992" href="#5911" class="Bound">n≡m</a> <a id="5996" href="../code/fininj/Function.Base.html#3828" class="../code/fininj/Function Operator">⟨</a> <a id="5998" href="../code/fininj/Relation.Binary.PropositionalEquality.Core.html#1025" class="../code/fininj/Function">trans</a> <a id="6004" href="../code/fininj/Function.Base.html#3828" class="../code/fininj/Function Operator">⟩</a> <a id="6006" href="../code/fininj/Relation.Binary.PropositionalEquality.Core.html#1131" class="../code/fininj/Function">cong</a> <a id="6011" class="Symbol">(</a><a id="6012" href="../code/fininj/Data.Fin.Base.html#1061" class="Datatype">Fin</a> <a id="6016" href="../code/fininj/Function.Base.html#992" class="../code/fininj/Function Operator">∘</a> <a id="6018" href="../code/fininj/Agda.Builtin.Nat.html#196" class="InductiveConstructor">suc</a><a id="6021" class="Symbol">)</a> <a id="6023" class="Symbol">(</a><a id="6024" href="../code/fininj/Data.Nat.Properties.html#12828" class="../code/fininj/Function">+-comm</a> <a id="6031" href="#5907" class="Bound">n</a> <a id="6033" href="#5909" class="Bound">m</a><a id="6034" class="Symbol">))</a>
                             <a id="6066" class="Symbol">(</a><a id="6067" href="../code/fininj/Function.Base.html#615" class="../code/fininj/Function">id</a> <a id="6070" href="../code/fininj/Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="6072" href="../code/fininj/Function.Base.html#615" class="../code/fininj/Function">id</a><a id="6074" class="Symbol">)))</a>

<a id="Fin-inj"></a><a id="6079" href="#6079" class="../code/fininj/Function">Fin-inj</a> <a id="6087" class="Symbol">:</a> <a id="6089" href="#5400" class="../code/fininj/Function">Injective</a> <a id="6099" href="../code/fininj/Data.Fin.Base.html#1061" class="Datatype">Fin</a>
<a id="6103" href="#6079" class="../code/fininj/Function">Fin-inj</a> <a id="6111" class="Symbol">{</a><a id="6112" href="#6112" class="Bound">n</a><a id="6113" class="Symbol">}</a> <a id="6115" class="Symbol">{</a><a id="6116" href="#6116" class="Bound">m</a><a id="6117" class="Symbol">}</a> <a id="6119" href="#6119" class="Bound">n≡m</a> <a id="6123" class="Keyword">with</a> <a id="6128" href="../code/fininj/Data.Nat.Base.html#3697" class="../code/fininj/Function">compare</a> <a id="6136" href="#6112" class="Bound">n</a> <a id="6138" href="#6116" class="Bound">m</a>
<a id="6140" class="Symbol">...</a> <a id="6144" class="Symbol">|</a> <a id="6146" href="../code/fininj/Data.Nat.Base.html#3620" class="InductiveConstructor">equal</a> <a id="6152" class="Symbol">_</a> <a id="6154" class="Symbol">=</a> <a id="6156" href="../code/fininj/Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
<a id="6161" class="Symbol">...</a> <a id="6165" class="Symbol">|</a> <a id="6167" href="../code/fininj/Data.Nat.Base.html#3575" class="InductiveConstructor">less</a>    <a id="6175" class="Bound">n</a> <a id="6177" href="#6177" class="Bound">k</a> <a id="6179" class="Symbol">=</a> <a id="6181" href="../code/fininj/Data.Empty.html#275" class="../code/fininj/Function">⊥-elim</a> <a id="6188" class="Symbol">(</a><a id="6189" href="#5857" class="../code/fininj/Function">n≢sn+m</a> <a id="6196" class="Bound">n</a> <a id="6198" href="#6177" class="Bound">k</a> <a id="6200" class="Bound">n≡m</a><a id="6203" class="Symbol">)</a>
<a id="6205" class="Symbol">...</a> <a id="6209" class="Symbol">|</a> <a id="6211" href="../code/fininj/Data.Nat.Base.html#3653" class="InductiveConstructor">greater</a> <a id="6219" class="Bound">m</a> <a id="6221" href="#6221" class="Bound">k</a> <a id="6223" class="Symbol">=</a> <a id="6225" href="../code/fininj/Data.Empty.html#275" class="../code/fininj/Function">⊥-elim</a> <a id="6232" class="Symbol">(</a><a id="6233" href="#5857" class="../code/fininj/Function">n≢sn+m</a> <a id="6240" class="Bound">m</a> <a id="6242" href="#6221" class="Bound">k</a> <a id="6244" class="Symbol">(</a><a id="6245" href="../code/fininj/Relation.Binary.PropositionalEquality.Core.html#980" class="../code/fininj/Function">sym</a> <a id="6249" class="Bound">n≡m</a><a id="6252" class="Symbol">))</a>

<a id="6256" href="#6256" class="../code/fininj/Function">_</a> <a id="6258" class="Symbol">:</a> <a id="6260" href="#1153" class="../code/fininj/Function">Goal</a>
<a id="6265" class="Symbol">_</a> <a id="6267" class="Symbol">=</a> <a id="6269" href="#6079" class="../code/fininj/Function">Fin-inj</a>
</pre>
<p>All in all, the proof is about 36 lines, which is pretty short for what it does.</p>

        </div>
        <div id="footer">
            Site proudly generated by
            <a href="http://jaspervdj.be/hakyll">Hakyll</a>
        </div>
    </body>
</html>
